<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Personality OS</title>
<style>
:root {
  --primary: #4c6ef5;
  --secondary: #f0f4ff;
  --background: #f9fbff;
  --card-bg: #ffffff;
  --border: #d0d7e2;
}
body {
  font-family: Arial, sans-serif;
  margin: 0;
  background-color: var(--background);
  color: #333;
}
header {
  background-color: var(--primary);
  color: white;
  padding: 20px;
  text-align: center;
}
nav {
  background-color: var(--secondary);
  display: flex;
  justify-content: center;
  gap: 20px;
  padding: 10px;
}
nav a {
  color: #333;
  text-decoration: none;
  font-weight: bold;
  cursor: pointer;
}
nav a.active {
  border-bottom: 2px solid var(--primary);
}
section { padding: 20px; display: none; }
section.active { display: block; }
.card {
  background-color: var(--card-bg);
  border: 1px solid var(--border);
  padding: 15px;
  border-radius: 6px;
  margin-bottom: 15px;
}
button {
  background-color: var(--primary);
  color: white;
  border: none;
  padding: 6px 12px;
  border-radius: 4px;
  cursor: pointer;
}
button.completed {
  background-color: #2f9e44;
}
table {
  width: 100%;
  border-collapse: collapse;
}
table th, table td {
  border: 1px solid var(--border);
  padding: 8px;
  vertical-align: top;
}
small { color: #555; }
</style>
</head>
<body>
<header>
  <h1>Personality OS</h1>
</header>
<nav>
  <a id="homeTab" class="active">Home</a>
  <a id="calendarTab">Calendar</a>
  <a id="notesTab">Notes</a>
</nav>

<section id="homeSection" class="active">
  <div class="card">
    <h2>Welcome</h2>
    <p id="quoteText"></p>
  </div>
</section>

<section id="calendarSection">
  <div class="card">
    <div style="display:flex; justify-content: space-between; align-items:center;">
      <div>
        <button id="prevBtn"><</button>
        <button id="nextBtn">></button>
      </div>
      <div>
        <select id="viewSelect">
          <option value="day">Day</option>
          <option value="week">Week</option>
          <option value="month">Month</option>
        </select>
      </div>
    </div>
    <div id="calendarContainer" style="margin-top:15px;"></div>
  </div>
</section>

<section id="notesSection">
  <div class="card">
    <h2>Growth Log & Notes</h2>
    <textarea id="noteInput" rows="4" style="width:100%;" placeholder="Write your note here..."></textarea><br>
    <button id="addNote">Add Note</button>
    <ul id="noteList"></ul>
  </div>
</section>

<script>
// Quotes for home page
const quotes = [
  "Growth is never by mere chance; it is the result of forces working together.",
  "Your personality is a work of art; shape it with intention.",
  "Small daily improvements are the key to staggering long-term results.",
  "Self-awareness is the foundation of self-mastery.",
  "Every day is a chance to become a better version of yourself."
];

// Topics for micro learning / journaling / essays
const topics = [
  { type:'Micro Learning', text:'Learn about the Iceberg Model and identify hidden beliefs behind actions.' },
  { type:'Journaling', text:'Reflect on a recent challenge and how you felt beneath the surface.' },
  { type:'Essay', text:'Write an essay on how your beliefs influence your behaviour.' },
  { type:'Micro Learning', text:'Explore the Big Five traits and note where you score high or low.' },
  { type:'Journaling', text:'Write about a time you felt autonomous, competent, and connected.' },
  { type:'Essay', text:'Consider what flourishing means to you in the context of PERMA.' }
];

// Workout schedule (0=Sunday)
const workoutSchedule = {
  0:'Sports',
  1:'Swimming',
  2:'Weights',
  3:'Rest',
  4:'Sports',
  5:'Swimming',
  6:'Weights'
};

let currentDate = new Date();
let currentView = 'day';

function showSection(section) {
  document.querySelectorAll('nav a').forEach(tab => tab.classList.remove('active'));
  document.querySelectorAll('section').forEach(sec => sec.classList.remove('active'));
  if(section === 'home') {
    document.getElementById('homeTab').classList.add('active');
    document.getElementById('homeSection').classList.add('active');
  } else if(section === 'calendar') {
    document.getElementById('calendarTab').classList.add('active');
    document.getElementById('calendarSection').classList.add('active');
    renderCalendar();
  } else if(section === 'notes') {
    document.getElementById('notesTab').classList.add('active');
    document.getElementById('notesSection').classList.add('active');
    loadNotes();
  }
}

function randomQuote() {
  const q = quotes[Math.floor(Math.random() * quotes.length)];
  document.getElementById('quoteText').textContent = q;
}

function formatDate(date) {
  const y = date.getFullYear();
  const m = String(date.getMonth()+1).padStart(2,'0');
  const d = String(date.getDate()).padStart(2,'0');
  return `${y}-${m}-${d}`;
}

function getTopicForIndex(i) {
  return topics[(i % topics.length + topics.length) % topics.length];
}

// Render functions for calendar
function renderCalendar() {
  const container = document.getElementById('calendarContainer');
  const view = currentView;
  if(view === 'day') {
    renderDayView(container);
  } else if(view === 'week') {
    renderWeekView(container);
  } else {
    renderMonthView(container);
  }
}

function renderDayView(container) {
  const date = new Date(currentDate);
  const today = new Date();
  const diffDays = Math.floor((date - today) / (1000*60*60*24));
  const dateStr = formatDate(date);
  const topic = getTopicForIndex(diffDays);
  const workout = workoutSchedule[date.getDay()];
  const taskKey = 'taskComplete_'+dateStr;
  const workoutKey = 'workoutComplete_'+dateStr;
  const weightKey = 'weight_'+dateStr;
  const taskDone = localStorage.getItem(taskKey) === 'true';
  const workoutDone = localStorage.getItem(workoutKey) === 'true';
  const weightVal = localStorage.getItem(weightKey) || '';
  let html = '<h3>'+dateStr+'</h3>';
  html += '<table><tr><th>Type</th><th>Description</th><th>Action</th></tr>';
  html += `<tr><td>${topic.type}</td><td>${topic.text}</td><td><button class="taskBtn ${taskDone?'completed':''}" data-date="${dateStr}">${taskDone?'Done':'Mark Complete'}</button></td></tr>`;
  html += `<tr><td>Workout</td><td>${workout}</td><td>`;
  if(workout === 'Rest'){
    html += 'Rest Day';
  } else {
    html += `<button class="workoutBtn ${workoutDone?'completed':''}" data-date="${dateStr}">${workoutDone?'Done':'Mark Complete'}</button>`;
  }
  html += '</td></tr>';
  if(date.getDay() === 0) {
    html += `<tr><td>Weight</td><td><input type="number" class="weightInput" data-date="${dateStr}" style="width:80px;" value="${weightVal}"></td><td></td></tr>`;
  }
  html += '</table>';
  container.innerHTML = html;
  attachCalendarListeners();
}

function renderWeekView(container) {
  const temp = new Date(currentDate);
  const start = new Date(temp);
  start.setDate(temp.getDate() - temp.getDay()); // start on Sunday
  let html = '<h3>Week of '+formatDate(start)+'</h3>';
  html += '<table><tr>';
  for(let i=0;i<7;i++){
    const d = new Date(start);
    d.setDate(start.getDate()+i);
    html += '<th>'+formatDate(d)+'</th>';
  }
  html += '</tr><tr>';
  for(let i=0;i<7;i++){
    const d = new Date(start);
    d.setDate(start.getDate()+i);
    const dateStr = formatDate(d);
    const diffDays = Math.floor((d - new Date())/(1000*60*60*24));
    const topic = getTopicForIndex(diffDays);
    const workout = workoutSchedule[d.getDay()];
    const taskKey = 'taskComplete_'+dateStr;
    const workoutKey = 'workoutComplete_'+dateStr;
    const weightKey = 'weight_'+dateStr;
    const taskDone = localStorage.getItem(taskKey)==='true';
    const workoutDone = localStorage.getItem(workoutKey)==='true';
    const weightVal = localStorage.getItem(weightKey)||'';
    html += '<td>';
    html += `<div><strong>${topic.type}</strong><br>${topic.text}<br><button class="taskBtn ${taskDone?'completed':''}" data-date="${dateStr}">${taskDone?'Done':'Mark'}</button></div>`;
    html += `<div><strong>Workout:</strong> ${workout}<br>`;
    if(workout==='Rest') {
      html += 'Rest Day';
    } else {
      html += `<button class="workoutBtn ${workoutDone?'completed':''}" data-date="${dateStr}">${workoutDone?'Done':'Mark'}</button>`;
    }
    html += '</div>';
    if(d.getDay()===0){
      html += `<div><strong>Weight:</strong><input type="number" class="weightInput" data-date="${dateStr}" style="width:80px;" value="${weightVal}"></div>`;
    }
    html += '</td>';
  }
  html += '</tr></table>';
  container.innerHTML = html;
  attachCalendarListeners();
}

function renderMonthView(container) {
  const year = currentDate.getFullYear();
  const month = currentDate.getMonth();
  const firstDay = new Date(year, month, 1);
  const startDay = firstDay.getDay();
  const daysInMonth = new Date(year, month+1, 0).getDate();
  let html = `<h3>${year}-${String(month+1).padStart(2,'0')}</h3>`;
  html += '<table><tr>';
  const daysOfWeek = ['Sun','Mon','Tue','Wed','Thu','Fri','Sat'];
  daysOfWeek.forEach(d=>{ html += '<th>'+d+'</th>'; });
  html += '</tr><tr>';
  for(let i=0;i<startDay;i++){
    html += '<td></td>';
  }
  for(let day=1; day<=daysInMonth; day++){
    const d = new Date(year, month, day);
    const dateStr = formatDate(d);
    const diffDays = Math.floor((d - new Date())/(1000*60*60*24));
    const topic = getTopicForIndex(diffDays);
    const workout = workoutSchedule[d.getDay()];
    const taskKey = 'taskComplete_'+dateStr;
    const workoutKey = 'workoutComplete_'+dateStr;
    const weightKey = 'weight_'+dateStr;
    const taskDone = localStorage.getItem(taskKey)==='true';
    const workoutDone = localStorage.getItem(workoutKey)==='true';
    const weightVal = localStorage.getItem(weightKey)||'';
    html += '<td style="min-width:140px;">';
    html += '<div><strong>'+day+'</strong></div>';
    html += `<div><small>${topic.type}</small> <button class="taskBtn ${taskDone?'completed':''}" data-date="${dateStr}">${taskDone?'\u2713':'Mark'}</button></div>`;
    html += `<div><small>${workout}</small> `;
    if(workout==='Rest') {
      html += '';
    } else {
      html += `<button class="workoutBtn ${workoutDone?'completed':''}" data-date="${dateStr}">${workoutDone?'\u2713':'Mark'}</button>`;
    }
    html += '</div>';
    if(d.getDay()===0){
      html += `<div><small>Wt:</small><input type="number" class="weightInput" data-date="${dateStr}" style="width:60px;" value="${weightVal}"></div>`;
    }
    html += '</td>';
    if((startDay + day) % 7 === 0 && day !== daysInMonth){
      html += '</tr><tr>';
    }
  }
  const totalCells = startDay + daysInMonth;
  const remaining = 7 - (totalCells % 7);
  if(remaining < 7){
    for(let i=0;i<remaining;i++){
      html += '<td></td>';
    }
  }
  html += '</tr></table>';
  container.innerHTML = html;
  attachCalendarListeners();
}

function attachCalendarListeners() {
  document.querySelectorAll('.taskBtn').forEach(btn=>{
    btn.addEventListener('click', function(){
      const dateStr = this.getAttribute('data-date');
      const key = 'taskComplete_'+dateStr;
      if(localStorage.getItem(key)==='true') {
        localStorage.removeItem(key);
      } else {
        localStorage.setItem(key, 'true');
      }
      renderCalendar();
    });
  });
  document.querySelectorAll('.workoutBtn').forEach(btn=>{
    btn.addEventListener('click', function(){
      const dateStr = this.getAttribute('data-date');
      const key = 'workoutComplete_'+dateStr;
      if(localStorage.getItem(key)==='true') {
        localStorage.removeItem(key);
      } else {
        localStorage.setItem(key, 'true');
      }
      renderCalendar();
    });
  });
  document.querySelectorAll('.weightInput').forEach(input=>{
    input.addEventListener('change', function(){
      const dateStr = this.getAttribute('data-date');
      const key = 'weight_'+dateStr;
      if(this.value) {
        localStorage.setItem(key, this.value);
      } else {
        localStorage.removeItem(key);
      }
    });
  });
}

// Notes
function loadNotes() {
  const notes = JSON.parse(localStorage.getItem('notes') || '[]');
  const list = document.getElementById('noteList');
  list.innerHTML = '';
  notes.forEach(n=>{
    const li = document.createElement('li');
    li.textContent = n;
    list.appendChild(li);
  });
}

document.getElementById('addNote').addEventListener('click', function(){
  const input = document.getElementById('noteInput');
  const text = input.value.trim();
  if(text) {
    const notes = JSON.parse(localStorage.getItem('notes') || '[]');
    notes.push(text);
    localStorage.setItem('notes', JSON.stringify(notes));
    input.value = '';
    loadNotes();
  }
});

// Nav events
document.getElementById('homeTab').addEventListener('click', ()=>{ showSection('home'); randomQuote(); });
document.getElementById('calendarTab').addEventListener('click', ()=>{ showSection('calendar'); });
document.getElementById('notesTab').addEventListener('click', ()=>{ showSection('notes'); });

document.getElementById('prevBtn').addEventListener('click', ()=>{
  if(currentView === 'day'){
    currentDate.setDate(currentDate.getDate() - 1);
  } else if(currentView === 'week'){
    currentDate.setDate(currentDate.getDate() - 7);
  } else {
    currentDate.setMonth(currentDate.getMonth() - 1);
  }
  renderCalendar();
});
document.getElementById('nextBtn').addEventListener('click', ()=>{
  if(currentView === 'day'){
    currentDate.setDate(currentDate.getDate() + 1);
  } else if(currentView === 'week'){
    currentDate.setDate(currentDate.getDate() + 7);
  } else {
    currentDate.setMonth(currentDate.getMonth() + 1);
  }
  renderCalendar();
});
document.getElementById('viewSelect').addEventListener('change', function(){
  currentView = this.value;
  renderCalendar();
});

// Initialize
randomQuote();
showSection('home');
renderCalendar();
loadNotes();
</script>
</body>
</html>
